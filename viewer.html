<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ad Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src * data: blob: filesystem: about: ws: wss: 'unsafe-inline' 'unsafe-eval'; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'; connect-src *; frame-src *; img-src * data: blob:; font-src * data:;">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; }
    #header-container, #footer-container, #nav-container { width: 100%; }
    .scroll-banner {
      background: yellow; color: red; font-weight: bold;
      padding: 5px; white-space: nowrap; overflow: hidden;
    }
    .scroll-banner span {
      display: inline-block; padding-left: 100%; animation: scroll-left 20s linear infinite;
    }
    @keyframes scroll-left {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }
    .invite-bar {
      background: lightgray; text-align: center; padding: 5px;
    }
    .invite-bar a {
      text-decoration: none; font-weight: bold; color: blue;
    }
    .ad-bar {
      background: wheat;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 5px;
      max-height: 70px;
      overflow: hidden;
    }
    .ad-bar img {
      height: 60px;
      max-width: 468px;
      object-fit: contain;
    }
    .ad-bar .text-ad {
      font-size: 14px;
      text-align: right;
      color: blue;
      text-decoration: underline;
      padding-left: 10px;
    }
    iframe {
      width: 100%;
      height: 1000px;
      border: none;
    }
  </style>
  <script defer src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
</head>
<body>

  <div id="header-container"></div>

  <div class="scroll-banner"><span>SCROLL TO VIEW ALL ADS!</span></div>

  <div class="invite-bar">
    <a href="https://saphahcentral.github.io/lla5785v3-0/account1.html" target="_blank">
      ðŸ‘‰ ADD YOUR WEBSITE HERE FOR MAXIMUM LIFETIME EXPOSURE!
    </a>
  </div>

  <div class="ad-bar" id="ad-bar">
    <!-- Filled by JS -->
  </div>

  <iframe id="ad-iframe" src="about:blank" loading="lazy"></iframe>

  <div id="nav-container"></div>
  <div id="footer-container"></div>

  <script>
    const fallbackAds = [
      {
        image: "https://scontent.fkxe1-1.fna.fbcdn.net/v/t39.30808-6/475751225_1043127917848227_6558230498504528156_n.jpg?...",
        url: "https://queenbutterfly.org.za/",
        banner: "https://scontent.fkxe1-1.fna.fbcdn.net/v/t39.30808-6/475751225_1043127917848227_6558230498504528156_n.jpg?...",
        text: "Help the metal and physical disabled"
      },
      {
        image: "https://cdn-images.imagevenue.com/5a/c1/97/ME1AXEOC_o.png",
        url: "https://lla5785emails.blogspot.com/p/subscribe.html",
        banner: "https://cdn-images.imagevenue.com/5a/c1/97/ME1AXEOC_o.png",
        text: "10 emails - a lifetime of information about online marketing"
      },
      {
        image: "https://cdn-thumbs.imagevenue.com/39/f4/40/ME1AXERE_b.jpg",
        url: "https://estcourthospice.blogspot.com/p/home.html",
        banner: "https://cdn-thumbs.imagevenue.com/39/f4/40/ME1AXERE_b.jpg",
        text: "Terminal illness support - donations welcome"
      },
      {
        image: "https://via.placeholder.com/468x60?text=JOB+OPP",
        url: "https://jobopp.com/main.cig?rr9346",
        banner: "https://via.placeholder.com/468x60?text=JOB+OPP",
        text: "Work from home with JOB OPP â€“ opportunities await!"
      }
    ];

    const firebaseConfig = {
      apiKey: "AIzaSyBBn8RmuXVvkbbBB0IquYr9S6hXhIgrQCQ",
      authDomain: "lla5785.firebaseapp.com",
      projectId: "lla5785",
      storageBucket: "lla5785.appspot.com",
      messagingSenderId: "730972554331",
      appId: "1:730972554331:web:d97a5fbacebd6aa6e32b7e"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function pickRandom(array, count) {
      const shuffled = [...array].sort(() => 0.5 - Math.random());
      return shuffled.slice(0, count);
    }

    async function loadAds() {
      try {
        const snapshot = await db.collection("ad_list").get();
        const ads = snapshot.docs.map(doc => doc.data());
        const [bannerAd, textAd, iframeAd] = pickRandom(ads, 3);
        displayAds(bannerAd, textAd, iframeAd);
      } catch (e) {
        console.warn("Firestore failed, using fallback ads", e);
        const [bannerAd, textAd, iframeAd] = pickRandom(fallbackAds, 3);
        displayAds(bannerAd, textAd, iframeAd);
      }
    }

    function displayAds(bannerAd, textAd, iframeAd) {
      const adBar = document.getElementById("ad-bar");
      adBar.innerHTML = `
        <a href="${bannerAd.url}" target="_blank">
          <img src="${bannerAd.banner}" alt="Banner Ad">
        </a>
        <a href="${textAd.url}" target="_blank" class="text-ad">${textAd.text}</a>
      `;
      document.getElementById("ad-iframe").src = iframeAd.url;
    }

    // Load external sections
    fetch("header.html").then(res => res.text()).then(html => {
      document.getElementById("header-container").innerHTML = html;
    });
    fetch("nav_external.html").then(res => res.text()).then(html => {
      document.getElementById("nav-container").innerHTML = html;
    });
    fetch("footer.html").then(res => res.text()).then(html => {
      document.getElementById("footer-container").innerHTML = html;
    });

    window.onload = loadAds;
  </script>
</body>
</html>
