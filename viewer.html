<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Viewer - Ads Display</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 10px;
  }
  #squareBanner {
    width: 125px;
    height: 125px;
    margin: 10px auto;
    display: block;
  }
  #bannerAd {
    max-width: 468px;
    max-height: 60px;
    margin: 10px auto;
    display: block;
  }
  #iframeAd {
    width: 468px;
    height: 60px;
    border: none;
    margin: 10px auto;
  }
  #textAd {
    margin: 10px auto;
    font-size: 16px;
    color: #333;
    max-width: 468px;
    min-height: 30px;
  }
</style>
</head>
<body>

<!-- Square banner linking to index.html -->
<a href="index.html" title="Home">
  <img id="squareBanner" src="https://cdn-images.imagevenue.com/64/1b/fc/ME1AW7GR_o.png" alt="Square Banner" />
</a>

<!-- Banner ad placeholder -->
<a id="bannerLink" href="#" target="_blank" rel="noopener noreferrer">
  <img id="bannerAd" src="" alt="Banner Ad" />
</a>

<!-- Text ad placeholder -->
<div id="textAd"></div>

<!-- Iframe ad placeholder -->
<iframe id="iframeAd" src="" title="Iframe Ad"></iframe>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
  // Your Firebase config - replace with your own
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_MSG_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  let ads = [];

  async function loadAds() {
    try {
      const snapshot = await db.collection('ad_list').get();
      ads = snapshot.docs.map(doc => doc.data());
      showRandomAds();
    } catch (error) {
      console.error('Error loading ads:', error);
      // Fallback to hardcoded ads or empty placeholders if needed
    }
  }

  function showRandomAds() {
    if (!ads.length) {
      console.warn('No ads found.');
      // Clear all ad slots
      document.getElementById('bannerLink').href = "#";
      document.getElementById('bannerAd').src = "";
      document.getElementById('bannerAd').alt = "";
      document.getElementById('textAd').textContent = "";
      document.getElementById('iframeAd').src = "";
      return;
    }

    // Filter by ad type
    const bannerAds = ads.filter(ad => ad.banner && ad.url);
    const textAds = ads.filter(ad => ad.text);
    const iframeAds = ads.filter(ad => ad.iframe);

    // Select random banner ad or fallback to empty
    const randomBanner = bannerAds.length ? bannerAds[Math.floor(Math.random() * bannerAds.length)] : null;
    if (randomBanner) {
      document.getElementById('bannerLink').href = randomBanner.url;
      document.getElementById('bannerAd').src = randomBanner.banner;
      document.getElementById('bannerAd').alt = randomBanner.text || "Banner Ad";
    } else {
      document.getElementById('bannerLink').href = "#";
      document.getElementById('bannerAd').src = "";
      document.getElementById('bannerAd').alt = "";
    }

    // Select random text ad or clear
    const randomText = textAds.length ? textAds[Math.floor(Math.random() * textAds.length)] : null;
    document.getElementById('textAd').textContent = randomText ? randomText.text : "";

    // Select random iframe ad or clear
    const randomIframe = iframeAds.length ? iframeAds[Math.floor(Math.random() * iframeAds.length)] : null;
    document.getElementById('iframeAd').src = randomIframe ? randomIframe.iframe : "";
  }

  // Load ads on page load
  window.onload = loadAds;
</script>

</body>
</html>
